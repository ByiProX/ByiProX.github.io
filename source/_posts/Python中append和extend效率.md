---
title: Python中append和extend效率
date: 2018-11-27 15:29:14
tags:
  - Python3
categories:
  - Python3 进阶
---
python提供了一个名为extend的方法，该方法将一个列表中的所有元素添加到另一个列表的结尾。在作用上，调用`data.extend(other)`的输出结果与以下代码的输出结果相同。
```Python
for elem in other:
    data.append(elem)

```
在任何情况下，运行时间都正比于另一张列表的长度，并且之所以`摊销`，是因为第一张列表的底层数组需要调整打下以容纳增添的元素。

在实践中，相对于重复调用append方法，我们更倾向于选择extend方法。原因是渐进分析中隐含的常数明显更小。extend方法效率更高体现在三个方面：

1. 首先，使用合适的python方法总会有一些优势，因为这些方法通常使用本地编译语言执行
2. 与调用很多独立的方法相比，调用一个函数完成所有工作的开销更小。
3. `extend提升的效率来源更新列表的最终大小能提前计算出。`例如第二个数据集是非常大的，当重复调用append时，底层动态数组会有很多次调整大小的风险，如果调用一次extend方法，最多执行一次调整工作。

<!-- more -->

我们所熟悉的构造新列表的语法，在几乎所有情况下，该行为的渐进效率在创建列表的长度方面是线性的。但是不同的方法在
实际效率上会有不同。

在python中经常使用一个诸如`squares = [k*k for k in range(1, n+1)]`的例子作为
```Python
squares = []
for k in range(1, n+1)
    squares.append(k*k)

```
的一种速记，并由此引入了列表推导式。实验可以证明用列表推导式语法比不断增添数据来创建列表速度更快。

类似的，使用乘法操作初始化一个固定的列表，也是一种很常见的python风格，例如`[0]*100`生成一张长度为100的列表，这样做不但语法简单，而且比逐步构造这样的表效率更高








-------
